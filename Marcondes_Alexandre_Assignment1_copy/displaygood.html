<!DOCTYPE html>
<html>

<head>
<!--ALEXANDRE MARCONDES author
      Credit for code from class ITM352 -- MR. KAZMAN and PORT 
    -->
<!--This code displays the products (all the balls) and it is also a form. The form is a method POST and will be evaluated on the server. -->
   
    <meta charset="utf-8">

    <title>We Got BALLs</title>

    <link href="https://fonts.googleapis.com/css?family=Cherry+Swash|Raleway" rel="stylesheet">

    <script type="text/javascript" src="./products_data.js"> </script>
    
     <script>
        function checkQuantityTextbox() {
            let input_string = document.getElementById('inputBox').value;
            let err_array = isNonNegativeInteger(input_string, true);
            if(err_array.length == 0){
            qty_textbox_message.innerHTML = input_string;
            }else {
            qty_textbox_message.innerHTML = err_array.join(";");
            }
        }

    // function isNonNegativeInteger (queryString, returnErrors = false) {
    //     errors = []; // assume no errors at first
    
    //     if(Number(queryString) != queryString){
    //        errors.push('Not a number!'); 
    //     }
    //     else {
    //       if (queryString < 0) errors.push('Negative value!'); // Check if it is non-negative
    //       if (parseInt(queryString) != queryString) errors.push('Not an integer!'); // Check that it is an integer
    //     }// Check if string is a number value
        
    //     if (returnErrors) {
    //         return errors;
    //     } else if (errors.length == 0) {
    //         return true;
    //     } else {
    //         return false;
    //     }
    // }</script> 


    <link rel="stylesheet" href="style1.css">
</head>


<!-- Create a post form POST method-->
<form name="quantity" action="/purchase" method="post">


    <body>


    <!--- Used code sample form Port -->
        <header>
            <h1>Get Your Game Ball Now</h1>
        </header>
        <div>
            <main>
                
                <script>
            //This creates a display of the products that will be sold.
            // the loop loops every item in the products_data.js 
            
                    for(i in products){
                        document.write(`
                        <section class="item">
                          <h2>${products[i].name}</h2>
                          <p>$ ${products[i].price}</p>
                          <img src=${products[i].image}>
                          <h4>
                              <label for"quantity${[i]}> Quantity: </label><br>
                              <input id="inputBox" style=display:"block" type="text" name="postQty${[i]}" value="0"><br>
                          </h4>
                        </section>
                    `)}
                </script>

            </main>
        </div>










        <script>  
        errQtyarray = []; 

        let params = (new URL(document.location)).searchParams;
            let GET = {};
            params.forEach(function(value, key){
            GET[key] = value;
            parseInt(errQtyarray.push(value));
      });



            // make the form sticky...
        
        for(i = 0; i < errQtyarray.length; i ++){
            if (params.has(`postQty${i}`)) {
                quantity[`postQty${i}`].value = params.get(`postQty${i}`);
                console.log(quantity[`postQty${i}`]);
                inputBox.innerHTML = quantity[`postQty${i}`].value ;
                   
                } 
            }
            </script>


        <footer>
            <h1>
                Best Quality in Town!!!
            </h1>
            <p><input type="submit" value="Purchase" id="buttonLike"></p>
        </footer>

    </body>
</form>

</html>